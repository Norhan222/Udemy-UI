<div class="chatbot-container">
  <!-- Overlay Background -->
  <div class="chat-overlay" [class.active]="showOverlay" (click)="closeChat()"></div>

  <!-- Chat Button -->

  <button class="chat-button" [disabled]="!(user$|async)"  (click)="openChat()">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
      <path
        d="M12 2C6.48 2 2 6.48 2 12c0 1.54.36 3 .97 4.29L2 22l5.71-.97C9 21.64 10.46 22 12 22c5.52 0 10-4.48 10-10S17.52 2 12 2zm0 18c-1.38 0-2.68-.29-3.86-.8l-.28-.13-2.89.49.49-2.89-.13-.28C4.79 14.68 4.5 13.38 4.5 12c0-4.14 3.36-7.5 7.5-7.5s7.5 3.36 7.5 7.5-3.36 7.5-7.5 7.5z" />
      <circle cx="9" cy="12" r="1" />
      <circle cx="12" cy="12" r="1" />
      <circle cx="15" cy="12" r="1" />
    </svg>
    <!-- <span class="notification-badge" *ngIf="showNotification">{{ notificationCount }}</span> -->
  </button>

  <!-- Chat Window -->
  <div class="chat-window" [class.active]="isOpen">
    <div class="chat-header">
      <div class="header-content">
        <div class="bot-avatar">ðŸŽ“</div>
        <div class="header-text">
          <h3>Udemy Assistant</h3>
          <div class="status">
            <span class="status-dot"></span>
            Available to help
          </div>
        </div>
      </div>
      <button class="close-btn" (click)="closeChat()">Ã—</button>
    </div>

    <div class="quick-questions">
      <button class="quick-btn" *ngFor="let q of quickQuestions" (click)="sendQuickQuestion(q.question)">
        {{ q.label }}
      </button>
    </div>

    <div class="chat-messages">
      <div class="message" [class.bot]="msg.sender === 'bot'" [class.user]="msg.sender === 'user'"
        *ngFor="let msg of messages">
        <div class="message-avatar">{{ msg.avatar }}</div>
        <div>
          <div class="message-content">{{ msg.text }}</div>
        </div>
      </div>

      <!-- Typing Indicator -->
      <div class="typing-indicator" [class.active]="isTyping">
        <div class="message-avatar" style="background: linear-gradient(135deg, #a435f0 0%, #8710d8 100%);">ðŸ¤–</div>
        <div class="typing-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>

    <div class="chat-input">
      <button class="attachment-btn" title="Attach file">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2">
          <path
            d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48" />
        </svg>
      </button>
      <input type="text" [(ngModel)]="messageInput" (keypress)="onKeyPress($event)"
        placeholder="Type your question here...">
      <button class="send-btn" (click)="sendMessage()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
        </svg>
      </button>
    </div>
  </div>
</div>
